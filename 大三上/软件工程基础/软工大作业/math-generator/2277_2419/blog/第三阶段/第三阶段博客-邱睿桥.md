# 四则运算训练系统博客

## 目录

1. 接口设计
   1. 需求分析
   2. 类的组织
   3. Information Hiding
   4. Interface Design
   5. Loose Coupling
2. 设计实现
   1. Model
   2. Controller
   3. View
3. 单元测试
4. 性能测试
5. 心得感悟



## 1. 接口设计

### 1.1 需求分析

根据用户第三阶段需求，项目需要用Windows图形界面实现，同时增加 “倒计时” 功能， 每个题目必须在 20 秒钟完成，如果完不成，则得0 分并进入下一题。增加“历史纪录” 功能， 把用户做题的成绩记录下来并可以展现历史记录。 增添乘方运算，并让用户自由选择乘方表示方式。

Model部分需要增添历史记录文件的读写存取操作。

Controller部分增添历史记录管理的功能，负责写入、读取、清除历史记录等。

View部分增添GUI界面，将前两阶段所有功能用控件形式实现，并增添倒计时和历史记录功能。

### 1.2 类的组织

Controller部分增添一个类：

* ManageRecord类：负责历史记录管理，包括写入、读取、清除历史记录等。

View部分增添一个类：

* Mainwindow类：GUI图形界面。

### 1.3 Information Hiding

信息隐藏主要通过类及类方法的封装实现，第三阶段在第二阶段基础上增添：

1. 将历史记录管理单独封装成一个类，实现历史记录功能。
2. 将历史记录文件的直接读写操作封装在文件类中。
3. 用户界面单独封装成为一个类。

### 1.4 Interface Design

MVC三个部分之间需要通过接口交换信息，第三阶段在第二阶段基础上增添：

* model部分和controller部分：历史记录操作命令和历史记录内容。
* controller部分和view部分：生成的题目、用户答案及判断结果、历史记录内容。

我们对这些需要交换的信息设置相应的接口并尽量保证接口在非必要时只读。

### 1.5 Loose Coupling

通过信息隐藏和接口设计，我们使得model部分，controller部分，view部分之间交换的信息达到最简，从而降低了项目的耦合度。

## 2. 设计实现

### 2.1 Model

队友实现

### 2.2 Controller

队友实现

### 2.3 View

在第二阶段的基础上增添GUI图形界面：

1. 图形界面实现前两个阶段的所有功能。用户运行GUI时，初界面让用户选择乘方表示形式，然后才生成题目，进入系统的开始界面。
2. 用户输入作答题目后可以开始答题，提交答案后系统不会立即进入下一题，而是进行答案判断并显示正确与否，此时点击“下一题”才会继续答题。
3. 每道题有20秒时间限制，时间到自动进行答案判断，若未作答则也算错误。倒计时用Qt的计时器实现。
4. 在每次答完一道题或一轮答题结束后会显示“结束”按钮，点击它系统会显示本次作答正确情况。再点击“返回”按钮可以返回开始界面，进行下一轮答题。
5. 历史记录除了最开始选择乘方表示方式时和答题过程中不能查看，其他时间可以随时查看。
6. 为了增添GUI图形界面的美观度，我们采用隐藏Qt窗口默认边框、自定义边框、手绘界面背景、添加窗口外部阴影等方式对图形界面进行美化，并且重写鼠标函数使界面可以随意拖动，方便用户操作。

## 3. 单元测试

单元测试主要是对类中方法特别是接口进行测试，并采用vs2019自带的代码覆盖率工具查看代码覆盖率。

## 4. 性能测试

软件测试包括性能测试、软件质量测试，这些都采用vs2019自带的代码测试工具实现，测试结果见测试文档。

## 5. 心得感悟

第三阶段在第二阶段的基础上添加GUI图形界面，还增添了倒计时功能，工作量比第二阶段多不少，时间主要是花在各种控件逻辑的实现和界面设计上，因为有的控件是动态生成、显示和隐藏的。此外图形界面比命令行操作更灵活，但也增加了用户非法输入的可能性，比如不输入题目答案直接提交等，因此需要比命令行设置更多的非法操作的反馈机制，与此同时还要防止非法信息向controller甚至是model传递导致破坏数据。
